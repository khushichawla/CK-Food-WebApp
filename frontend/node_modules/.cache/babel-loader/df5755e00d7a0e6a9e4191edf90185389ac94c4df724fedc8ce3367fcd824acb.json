{"ast":null,"code":"var _jsxFileName = \"/Users/khushichawla/Desktop/Projects/web-app/frontend/src/pages/LoginPage/LoginPage.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState } from 'react';\nimport './LoginPage.css';\nimport { StoreContext } from '../../context/StoreContext';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LoginPage = () => {\n  _s();\n  const {\n    url,\n    setToken,\n    setUserRole,\n    resetCart\n  } = useContext(StoreContext);\n  const [currState, setCurrState] = useState(\"Login\");\n  const [data, setData] = useState({\n    name: \"\",\n    phone: \"\",\n    password: \"\"\n  });\n  const navigate = useNavigate();\n  const onChangeHandler = event => {\n    const name = event.target.name;\n    const value = event.target.value;\n    setData(prevData => ({\n      ...prevData,\n      [name]: value\n    }));\n  };\n  const validatePhoneNumber = phone => {\n    const phonePattern = /^\\d{8}$/; // RegEx for exactly 8 digits\n    return phonePattern.test(phone); // Returns true if valid\n  };\n  const onLogin = async event => {\n    event.preventDefault();\n    if (!validatePhoneNumber(data.phone)) {\n      alert(\"Please enter a valid number.\");\n      return; // Exit the function if validation fails\n    }\n    const newUrl = currState === \"Login\" ? `${url}/api/user/login` : `${url}/api/user/register`;\n    try {\n      const response = await axios.post(newUrl, data);\n      if (response.data.success) {\n        setToken(response.data.token);\n        setUserRole(response.data.role);\n        localStorage.setItem(\"token\", response.data.token);\n        localStorage.setItem(\"userRole\", response.data.role);\n        resetCart();\n        window.location.reload(); // This will refresh the page\n\n        navigate(response.data.role === \"Admin\" ? \"/add\" : \"/\");\n      } else {\n        alert(response.data.message);\n      }\n    } catch (error) {\n      console.error(\"Login error:\", error);\n      alert(\"An error occurred. Please try again.\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login-popup\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: onLogin,\n      className: \"login-popup-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-popup-title\",\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: currState\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-popup-inputs\",\n        children: [currState === \"Login\" ? null : /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"name\",\n          onChange: onChangeHandler,\n          value: data.name,\n          type: \"text\",\n          placeholder: \"Your name\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"phone\",\n          onChange: onChangeHandler,\n          value: data.phone,\n          type: \"tel\" // Use 'tel' for phone input\n          ,\n          placeholder: \"Your phone number\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"password\",\n          onChange: onChangeHandler,\n          value: data.password,\n          type: \"password\",\n          placeholder: \"Your Password\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: currState === \"Sign Up\" ? \"Create account\" : \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), currState === 'Login' ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Create a new account? \", /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => setCurrState(\"Sign Up\"),\n          children: \"Click here\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 36\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Already have an account? \", /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => setCurrState(\"Login\"),\n          children: \"Login here\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 39\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s(LoginPage, \"6qP388gE9itYzCM8HJbUz+itKEI=\", false, function () {\n  return [useNavigate];\n});\n_c = LoginPage;\nexport default LoginPage;\nvar _c;\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"names":["React","useContext","useState","StoreContext","axios","useNavigate","jsxDEV","_jsxDEV","LoginPage","_s","url","setToken","setUserRole","resetCart","currState","setCurrState","data","setData","name","phone","password","navigate","onChangeHandler","event","target","value","prevData","validatePhoneNumber","phonePattern","test","onLogin","preventDefault","alert","newUrl","response","post","success","token","role","localStorage","setItem","window","location","reload","message","error","console","className","children","onSubmit","fileName","_jsxFileName","lineNumber","columnNumber","onChange","type","placeholder","required","onClick","_c","$RefreshReg$"],"sources":["/Users/khushichawla/Desktop/Projects/web-app/frontend/src/pages/LoginPage/LoginPage.js"],"sourcesContent":["import React, { useContext, useState } from 'react';\nimport './LoginPage.css';\nimport { StoreContext } from '../../context/StoreContext';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nconst LoginPage = () => {\n  const { url, setToken, setUserRole, resetCart } = useContext(StoreContext);\n  const [currState, setCurrState] = useState(\"Login\");\n  const [data, setData] = useState({\n    name: \"\",\n    phone: \"\",\n    password: \"\"\n  });\n  const navigate = useNavigate();\n\n  const onChangeHandler = (event) => {\n    const name = event.target.name;\n    const value = event.target.value;\n    setData((prevData) => ({ ...prevData, [name]: value }));\n  };\n\n  const validatePhoneNumber = (phone) => {\n    const phonePattern = /^\\d{8}$/; // RegEx for exactly 8 digits\n    return phonePattern.test(phone); // Returns true if valid\n  };\n\n  const onLogin = async (event) => {\n    event.preventDefault();\n\n    if (!validatePhoneNumber(data.phone)) {\n      alert(\"Please enter a valid number.\");\n      return; // Exit the function if validation fails\n    }\n\n    const newUrl = currState === \"Login\" ? `${url}/api/user/login` : `${url}/api/user/register`;\n\n    try {\n      const response = await axios.post(newUrl, data);\n      if (response.data.success) {\n        setToken(response.data.token);\n        setUserRole(response.data.role);\n        localStorage.setItem(\"token\", response.data.token);\n        localStorage.setItem(\"userRole\", response.data.role);\n        resetCart();\n        window.location.reload(); // This will refresh the page\n\n        navigate(response.data.role === \"Admin\" ? \"/add\" : \"/\");\n      } else {\n        alert(response.data.message);\n      }\n    } catch (error) {\n      console.error(\"Login error:\", error);\n      alert(\"An error occurred. Please try again.\");\n    }\n  };\n\n  return (\n    <div className='login-popup'>\n      <form onSubmit={onLogin} className='login-popup-container'>\n        <div className='login-popup-title'>\n          <h2>{currState}</h2>\n        </div>\n        <div className='login-popup-inputs'>\n          {currState === \"Login\" ? null : (\n            <input\n              name='name'\n              onChange={onChangeHandler}\n              value={data.name}\n              type='text'\n              placeholder='Your name'\n              required\n            />\n          )}\n          <input\n            name='phone'\n            onChange={onChangeHandler}\n            value={data.phone}\n            type='tel' // Use 'tel' for phone input\n            placeholder='Your phone number'\n            required\n          />\n          <input\n            name='password'\n            onChange={onChangeHandler}\n            value={data.password}\n            type='password'\n            placeholder='Your Password'\n            required\n          />\n        </div>\n        <button type='submit'>\n          {currState === \"Sign Up\" ? \"Create account\" : \"Login\"}\n        </button>\n        {currState === 'Login' ? (\n          <p>Create a new account? <span onClick={() => setCurrState(\"Sign Up\")}>Click here</span></p>\n        ) : (\n          <p>Already have an account? <span onClick={() => setCurrState(\"Login\")}>Login here</span></p>\n        )}\n      </form>\n    </div>\n  );\n};\n\nexport default LoginPage;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,QAAQ,QAAQ,OAAO;AACnD,OAAO,iBAAiB;AACxB,SAASC,YAAY,QAAQ,4BAA4B;AACzD,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,MAAMC,SAAS,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACtB,MAAM;IAAEC,GAAG;IAAEC,QAAQ;IAAEC,WAAW;IAAEC;EAAU,CAAC,GAAGZ,UAAU,CAACE,YAAY,CAAC;EAC1E,MAAM,CAACW,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,OAAO,CAAC;EACnD,MAAM,CAACc,IAAI,EAAEC,OAAO,CAAC,GAAGf,QAAQ,CAAC;IAC/BgB,IAAI,EAAE,EAAE;IACRC,KAAK,EAAE,EAAE;IACTC,QAAQ,EAAE;EACZ,CAAC,CAAC;EACF,MAAMC,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAE9B,MAAMiB,eAAe,GAAIC,KAAK,IAAK;IACjC,MAAML,IAAI,GAAGK,KAAK,CAACC,MAAM,CAACN,IAAI;IAC9B,MAAMO,KAAK,GAAGF,KAAK,CAACC,MAAM,CAACC,KAAK;IAChCR,OAAO,CAAES,QAAQ,KAAM;MAAE,GAAGA,QAAQ;MAAE,CAACR,IAAI,GAAGO;IAAM,CAAC,CAAC,CAAC;EACzD,CAAC;EAED,MAAME,mBAAmB,GAAIR,KAAK,IAAK;IACrC,MAAMS,YAAY,GAAG,SAAS,CAAC,CAAC;IAChC,OAAOA,YAAY,CAACC,IAAI,CAACV,KAAK,CAAC,CAAC,CAAC;EACnC,CAAC;EAED,MAAMW,OAAO,GAAG,MAAOP,KAAK,IAAK;IAC/BA,KAAK,CAACQ,cAAc,CAAC,CAAC;IAEtB,IAAI,CAACJ,mBAAmB,CAACX,IAAI,CAACG,KAAK,CAAC,EAAE;MACpCa,KAAK,CAAC,8BAA8B,CAAC;MACrC,OAAO,CAAC;IACV;IAEA,MAAMC,MAAM,GAAGnB,SAAS,KAAK,OAAO,GAAG,GAAGJ,GAAG,iBAAiB,GAAG,GAAGA,GAAG,oBAAoB;IAE3F,IAAI;MACF,MAAMwB,QAAQ,GAAG,MAAM9B,KAAK,CAAC+B,IAAI,CAACF,MAAM,EAAEjB,IAAI,CAAC;MAC/C,IAAIkB,QAAQ,CAAClB,IAAI,CAACoB,OAAO,EAAE;QACzBzB,QAAQ,CAACuB,QAAQ,CAAClB,IAAI,CAACqB,KAAK,CAAC;QAC7BzB,WAAW,CAACsB,QAAQ,CAAClB,IAAI,CAACsB,IAAI,CAAC;QAC/BC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEN,QAAQ,CAAClB,IAAI,CAACqB,KAAK,CAAC;QAClDE,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEN,QAAQ,CAAClB,IAAI,CAACsB,IAAI,CAAC;QACpDzB,SAAS,CAAC,CAAC;QACX4B,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAAC,CAAC;;QAE1BtB,QAAQ,CAACa,QAAQ,CAAClB,IAAI,CAACsB,IAAI,KAAK,OAAO,GAAG,MAAM,GAAG,GAAG,CAAC;MACzD,CAAC,MAAM;QACLN,KAAK,CAACE,QAAQ,CAAClB,IAAI,CAAC4B,OAAO,CAAC;MAC9B;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,cAAc,EAAEA,KAAK,CAAC;MACpCb,KAAK,CAAC,sCAAsC,CAAC;IAC/C;EACF,CAAC;EAED,oBACEzB,OAAA;IAAKwC,SAAS,EAAC,aAAa;IAAAC,QAAA,eAC1BzC,OAAA;MAAM0C,QAAQ,EAAEnB,OAAQ;MAACiB,SAAS,EAAC,uBAAuB;MAAAC,QAAA,gBACxDzC,OAAA;QAAKwC,SAAS,EAAC,mBAAmB;QAAAC,QAAA,eAChCzC,OAAA;UAAAyC,QAAA,EAAKlC;QAAS;UAAAoC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACjB,CAAC,eACN9C,OAAA;QAAKwC,SAAS,EAAC,oBAAoB;QAAAC,QAAA,GAChClC,SAAS,KAAK,OAAO,GAAG,IAAI,gBAC3BP,OAAA;UACEW,IAAI,EAAC,MAAM;UACXoC,QAAQ,EAAEhC,eAAgB;UAC1BG,KAAK,EAAET,IAAI,CAACE,IAAK;UACjBqC,IAAI,EAAC,MAAM;UACXC,WAAW,EAAC,WAAW;UACvBC,QAAQ;QAAA;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACT,CACF,eACD9C,OAAA;UACEW,IAAI,EAAC,OAAO;UACZoC,QAAQ,EAAEhC,eAAgB;UAC1BG,KAAK,EAAET,IAAI,CAACG,KAAM;UAClBoC,IAAI,EAAC,KAAK,CAAC;UAAA;UACXC,WAAW,EAAC,mBAAmB;UAC/BC,QAAQ;QAAA;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACT,CAAC,eACF9C,OAAA;UACEW,IAAI,EAAC,UAAU;UACfoC,QAAQ,EAAEhC,eAAgB;UAC1BG,KAAK,EAAET,IAAI,CAACI,QAAS;UACrBmC,IAAI,EAAC,UAAU;UACfC,WAAW,EAAC,eAAe;UAC3BC,QAAQ;QAAA;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACT,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eACN9C,OAAA;QAAQgD,IAAI,EAAC,QAAQ;QAAAP,QAAA,EAClBlC,SAAS,KAAK,SAAS,GAAG,gBAAgB,GAAG;MAAO;QAAAoC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC/C,CAAC,EACRvC,SAAS,KAAK,OAAO,gBACpBP,OAAA;QAAAyC,QAAA,GAAG,wBAAsB,eAAAzC,OAAA;UAAMmD,OAAO,EAAEA,CAAA,KAAM3C,YAAY,CAAC,SAAS,CAAE;UAAAiC,QAAA,EAAC;QAAU;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,gBAE5F9C,OAAA;QAAAyC,QAAA,GAAG,2BAAyB,eAAAzC,OAAA;UAAMmD,OAAO,EAAEA,CAAA,KAAM3C,YAAY,CAAC,OAAO,CAAE;UAAAiC,QAAA,EAAC;QAAU;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAC7F;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACG;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACJ,CAAC;AAEV,CAAC;AAAC5C,EAAA,CAhGID,SAAS;EAAA,QAQIH,WAAW;AAAA;AAAAsD,EAAA,GARxBnD,SAAS;AAkGf,eAAeA,SAAS;AAAC,IAAAmD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}