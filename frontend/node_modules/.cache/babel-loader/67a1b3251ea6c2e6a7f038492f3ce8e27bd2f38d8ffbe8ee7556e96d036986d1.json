{"ast":null,"code":"import React,{useContext,useState}from'react';import'./LoginPage.css';import{StoreContext}from'../../context/StoreContext';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginPage=()=>{const{url,setToken,setUserRole}=useContext(StoreContext);const[currState,setCurrState]=useState(\"Sign Up\");const[data,setData]=useState({name:\"\",phone:\"\",password:\"\"});const navigate=useNavigate();const onChangeHandler=event=>{const name=event.target.name;const value=event.target.value;setData(prevData=>({...prevData,[name]:value}));};const validatePhoneNumber=phone=>{const phonePattern=/^\\d{8}$/;// RegEx for exactly 8 digits\nreturn phonePattern.test(phone);// Returns true if valid\n};const onLogin=async event=>{event.preventDefault();if(!validatePhoneNumber(data.phone)){alert(\"Please enter a valid number.\");return;// Exit the function if validation fails\n}const newUrl=currState===\"Login\"?`${url}/api/user/login`:`${url}/api/user/register`;try{const response=await axios.post(newUrl,data);if(response.data.success){setToken(response.data.token);setUserRole(response.data.role);localStorage.setItem(\"token\",response.data.token);localStorage.setItem(\"userRole\",response.data.role);navigate(response.data.role===\"Admin\"?\"/add\":\"/\");}else{alert(response.data.message);}}catch(error){console.error(\"Login error:\",error);alert(\"An error occurred. Please try again.\");}};return/*#__PURE__*/_jsx(\"div\",{className:\"login-popup\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:onLogin,className:\"login-popup-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"login-popup-title\",children:/*#__PURE__*/_jsx(\"h2\",{children:currState})}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-popup-inputs\",children:[currState===\"Login\"?null:/*#__PURE__*/_jsx(\"input\",{name:\"name\",onChange:onChangeHandler,value:data.name,type:\"text\",placeholder:\"Your name\",required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"phone\",onChange:onChangeHandler,value:data.phone,type:\"tel\"// Use 'tel' for phone input\n,placeholder:\"Your phone number\",required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"password\",onChange:onChangeHandler,value:data.password,type:\"password\",placeholder:\"Your Password\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:currState===\"Sign Up\"?\"Create account\":\"Login\"}),currState==='Login'?/*#__PURE__*/_jsxs(\"p\",{children:[\"Create a new account? \",/*#__PURE__*/_jsx(\"span\",{onClick:()=>setCurrState(\"Sign Up\"),children:\"Click here\"})]}):/*#__PURE__*/_jsxs(\"p\",{children:[\"Already have an account? \",/*#__PURE__*/_jsx(\"span\",{onClick:()=>setCurrState(\"Login\"),children:\"Login here\"})]})]})});};export default LoginPage;","map":{"version":3,"names":["React","useContext","useState","StoreContext","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","LoginPage","url","setToken","setUserRole","currState","setCurrState","data","setData","name","phone","password","navigate","onChangeHandler","event","target","value","prevData","validatePhoneNumber","phonePattern","test","onLogin","preventDefault","alert","newUrl","response","post","success","token","role","localStorage","setItem","message","error","console","className","children","onSubmit","onChange","type","placeholder","required","onClick"],"sources":["/Users/khushichawla/Desktop/Projects/web-app/frontend/src/pages/LoginPage/LoginPage.js"],"sourcesContent":["import React, { useContext, useState } from 'react';\nimport './LoginPage.css';\nimport { StoreContext } from '../../context/StoreContext';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nconst LoginPage = () => {\n  const { url, setToken, setUserRole } = useContext(StoreContext);\n  const [currState, setCurrState] = useState(\"Sign Up\");\n  const [data, setData] = useState({\n    name: \"\",\n    phone: \"\",\n    password: \"\"\n  });\n  const navigate = useNavigate();\n\n  const onChangeHandler = (event) => {\n    const name = event.target.name;\n    const value = event.target.value;\n    setData((prevData) => ({ ...prevData, [name]: value }));\n  };\n\n  const validatePhoneNumber = (phone) => {\n    const phonePattern = /^\\d{8}$/; // RegEx for exactly 8 digits\n    return phonePattern.test(phone); // Returns true if valid\n  };\n\n  const onLogin = async (event) => {\n    event.preventDefault();\n\n    if (!validatePhoneNumber(data.phone)) {\n      alert(\"Please enter a valid number.\");\n      return; // Exit the function if validation fails\n    }\n\n    const newUrl = currState === \"Login\" ? `${url}/api/user/login` : `${url}/api/user/register`;\n\n    try {\n      const response = await axios.post(newUrl, data);\n      if (response.data.success) {\n        setToken(response.data.token);\n        setUserRole(response.data.role);\n        localStorage.setItem(\"token\", response.data.token);\n        localStorage.setItem(\"userRole\", response.data.role);\n\n        navigate(response.data.role === \"Admin\" ? \"/add\" : \"/\");\n      } else {\n        alert(response.data.message);\n      }\n    } catch (error) {\n      console.error(\"Login error:\", error);\n      alert(\"An error occurred. Please try again.\");\n    }\n  };\n\n  return (\n    <div className='login-popup'>\n      <form onSubmit={onLogin} className='login-popup-container'>\n        <div className='login-popup-title'>\n          <h2>{currState}</h2>\n        </div>\n        <div className='login-popup-inputs'>\n          {currState === \"Login\" ? null : (\n            <input\n              name='name'\n              onChange={onChangeHandler}\n              value={data.name}\n              type='text'\n              placeholder='Your name'\n              required\n            />\n          )}\n          <input\n            name='phone'\n            onChange={onChangeHandler}\n            value={data.phone}\n            type='tel' // Use 'tel' for phone input\n            placeholder='Your phone number'\n            required\n          />\n          <input\n            name='password'\n            onChange={onChangeHandler}\n            value={data.password}\n            type='password'\n            placeholder='Your Password'\n            required\n          />\n        </div>\n        <button type='submit'>\n          {currState === \"Sign Up\" ? \"Create account\" : \"Login\"}\n        </button>\n        {currState === 'Login' ? (\n          <p>Create a new account? <span onClick={() => setCurrState(\"Sign Up\")}>Click here</span></p>\n        ) : (\n          <p>Already have an account? <span onClick={() => setCurrState(\"Login\")}>Login here</span></p>\n        )}\n      </form>\n    </div>\n  );\n};\n\nexport default LoginPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}