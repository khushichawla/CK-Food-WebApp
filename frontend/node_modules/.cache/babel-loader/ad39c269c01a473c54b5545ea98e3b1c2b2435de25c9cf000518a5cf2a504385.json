{"ast":null,"code":"import React,{createContext,useEffect,useState}from\"react\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";export const StoreContext=/*#__PURE__*/createContext(null);const StoreContextProvider=props=>{const[cartItems,setCartItems]=useState({});const[url]=useState(\"https://ck-food-webapp-backend.onrender.com\");const[token,setToken]=useState(\"\");const[userRole,setUserRole]=useState(\"\");// Add user role state\nconst[food_list,setFoodlist]=useState([]);const addToCart=async itemId=>{setCartItems(prev=>{const updatedCart={...prev};updatedCart[itemId]=(updatedCart[itemId]||0)+1;// Increment item count\nreturn updatedCart;});if(token){try{await axios.post(url+\"/api/cart/add\",{itemId},{headers:{token}});}catch(error){console.error(\"Error adding to cart:\",error);}}};const removeFromCart=async itemId=>{setCartItems(prev=>{const updatedCart={...prev};updatedCart[itemId]=Math.max(0,updatedCart[itemId]-1);// Prevent negative count\nreturn updatedCart;});if(token){await axios.post(url+\"/api/cart/remove\",{itemId},{headers:{token}});}};const getTotalCartAmount=()=>{return Object.keys(cartItems).reduce((total,item)=>{const itemInfo=food_list.find(product=>product._id===item);return total+(itemInfo?itemInfo.price*cartItems[item]:0);},0);};const getTotalCartQuantity=()=>{return Object.values(cartItems).reduce((total,count)=>total+count,0);};const fetchFoodList=async()=>{const response=await axios.get(url+\"/api/food/list\");setFoodlist(response.data.data);};const loadCartData=async token=>{try{const response=await axios.get(url+\"/api/cart/get\",{headers:{token}});setCartItems(response.data.cartData);}catch(error){console.error(\"Error loading cart data:\",error);}};const resetCart=()=>{setCartItems({});};useEffect(()=>{async function loadData(){await fetchFoodList();const storedToken=localStorage.getItem(\"token\");const storedRole=localStorage.getItem(\"userRole\");if(storedToken){setToken(storedToken);setUserRole(storedRole||\"\");// Set user role\nawait loadCartData(storedToken);}}loadData();},[]);const contextValue={food_list,cartItems,setCartItems,addToCart,removeFromCart,getTotalCartAmount,getTotalCartQuantity,resetCart,url,token,setToken,userRole,// Provide userRole in context\nsetUserRole// Provide setUserRole in context\n};return/*#__PURE__*/_jsx(StoreContext.Provider,{value:contextValue,children:props.children});};export default StoreContextProvider;","map":{"version":3,"names":["React","createContext","useEffect","useState","axios","jsx","_jsx","StoreContext","StoreContextProvider","props","cartItems","setCartItems","url","token","setToken","userRole","setUserRole","food_list","setFoodlist","addToCart","itemId","prev","updatedCart","post","headers","error","console","removeFromCart","Math","max","getTotalCartAmount","Object","keys","reduce","total","item","itemInfo","find","product","_id","price","getTotalCartQuantity","values","count","fetchFoodList","response","get","data","loadCartData","cartData","resetCart","loadData","storedToken","localStorage","getItem","storedRole","contextValue","Provider","value","children"],"sources":["/Users/khushichawla/Desktop/Projects/web-app/frontend/src/context/StoreContext.js"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\nimport axios from 'axios';\n\nexport const StoreContext = createContext(null);\n\nconst StoreContextProvider = (props) => {\n    const [cartItems, setCartItems] = useState({});\n    const [url] = useState(\"https://ck-food-webapp-backend.onrender.com\");\n    const [token, setToken] = useState(\"\");\n    const [userRole, setUserRole] = useState(\"\"); // Add user role state\n    const [food_list, setFoodlist] = useState([]);\n\n    const addToCart = async (itemId) => {\n        setCartItems((prev) => {\n            const updatedCart = { ...prev };\n            updatedCart[itemId] = (updatedCart[itemId] || 0) + 1; // Increment item count\n            return updatedCart;\n        });\n\n        if (token) {\n            try {\n                await axios.post(url + \"/api/cart/add\", { itemId }, { headers: { token } });\n            } catch (error) {\n                console.error(\"Error adding to cart:\", error);\n            }\n        }\n    };\n\n    const removeFromCart = async (itemId) => {\n        setCartItems((prev) => {\n            const updatedCart = { ...prev };\n            updatedCart[itemId] = Math.max(0, updatedCart[itemId] - 1); // Prevent negative count\n            return updatedCart;\n        });\n\n        if (token) {\n            await axios.post(url + \"/api/cart/remove\", { itemId }, { headers: { token } });\n        }\n    };\n\n    const getTotalCartAmount = () => {\n        return Object.keys(cartItems).reduce((total, item) => {\n            const itemInfo = food_list.find((product) => product._id === item);\n            return total + (itemInfo ? itemInfo.price * cartItems[item] : 0);\n        }, 0);\n    };\n\n    const getTotalCartQuantity = () => {\n        return Object.values(cartItems).reduce((total, count) => total + count, 0);\n    };\n\n    const fetchFoodList = async () => {\n        const response = await axios.get(url + \"/api/food/list\");\n        setFoodlist(response.data.data);\n    };\n\n    const loadCartData = async (token) => {\n        try {\n            const response = await axios.get(url + \"/api/cart/get\", { headers: { token } });\n            setCartItems(response.data.cartData);\n        } catch (error) {\n            console.error(\"Error loading cart data:\", error);\n        }\n    };\n\n    const resetCart = () => {\n        setCartItems({});\n    };\n\n    useEffect(() => {\n        async function loadData() {\n            await fetchFoodList();\n            const storedToken = localStorage.getItem(\"token\");\n            const storedRole = localStorage.getItem(\"userRole\");\n            if (storedToken) {\n                setToken(storedToken);\n                setUserRole(storedRole || \"\"); // Set user role\n                await loadCartData(storedToken);\n            }\n        }\n        loadData();\n    }, []);\n\n    const contextValue = {\n        food_list,\n        cartItems,\n        setCartItems,\n        addToCart,\n        removeFromCart,\n        getTotalCartAmount,\n        getTotalCartQuantity,\n        resetCart,\n        url,\n        token,\n        setToken,\n        userRole, // Provide userRole in context\n        setUserRole // Provide setUserRole in context\n    };\n\n    return (\n        <StoreContext.Provider value={contextValue}>\n            {props.children}\n        </StoreContext.Provider>\n    );\n};\n\nexport default StoreContextProvider;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}